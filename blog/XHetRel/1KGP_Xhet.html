<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-11-30 Sat 15:14 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Investigating male X heterozygosity in short read sequencing</title>
<meta name="author" content="Barış Salman" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>

<script async src="https://analytics.umami.is/script.js" data-website-id="c0d0b77c-5c98-4814-9721-bb72437e9467"></script>
<link rel="shortcut icon" href="https://omics.sbs/static/base/img/fav.ico" />
<link rel="stylesheet" href="https://omics.sbs/static/base/css/latex.css" />
<link rel="stylesheet" href="https://omics.sbs/static/base/css/style.css" />
<style>img{max-width:100%}</style>
<style>details{background-color:#fff !important}</style>
<link href="https://cdn.jsdelivr.net/npm/zoom-vanilla.js/dist/zoom.css" rel="stylesheet">
<script data-isso="//comments.omics.sbs/" src="//comments.omics.sbs/js/embed.min.js"></script>
<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
// @license-end
</script>
</head>
<body>
<div id="preamble" class="status">

<script>
if (localStorage.darkMode == "true") {
  document.body.classList.add("latex-dark");
}
else {
  document.body.classList.remove("latex-dark");
}
if (localStorage.typeface == "Libertinus") {
    document.body.classList.add("libertinus")
}
else {
    document.body.classList.remove("libertinus")
}
</script>

    <ul id="navbar">
        <li>
            <a href="https://omics.sbs/">Home</a>
        </li>
        <li>
            <a href="https://omics.sbs/blog">Blog</a>
        </li>
        <li>
            <a href="https://omics.sbs/notes">Notes</a>
        </li>
        <li>
            <a href="https://omics.sbs/photos">Photos</a>
        </li>
        <li>
            <a href="https://omics.sbs/bioscripts">Bioscripts</a>
        </li>
        <li class="preferences">
            <button class="dark-mode-button" id="dark-mode-toggle" aria-label="Toggle color mode"
                title="Toggle color mode">
                <div class="sun">
                </div>
                <div class="moon">
                    <div class="star"></div>
                    <div class="star small"></div>
                </div>
            </button>
        </li>
        <li class="preferences">
            <input type="button" id="typeface-toggle" title="" value="Aa">
        </li>
    </ul>
</div>
<div id="content" class="content">
<h1 class="title">Investigating male X heterozygosity in short read sequencing</h1>
<div class="dateauthor" id="org0b593f1">
<p>
26 Jun 2024 — Barış Salman
</p>

<p>
Links
</p>
<ul class="org-ul">
<li><a href="https://github.com/barslmn/XhetRel">Source repository</a></li>
<li><a href="https://www.biostars.org/p/9597822/">Biostars post</a></li>
</ul>

</div>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org10035ad">1. Introduction</a>
<ul>
<li><a href="#orgf56fd9e">1.1. Calling variant from X chromosome in males</a></li>
</ul>
</li>
<li><a href="#orgd385aa1">2. Materials and Methods</a>
<ul>
<li><a href="#orga7ba070">2.1. VCF files from the 1000genome project</a></li>
<li><a href="#org65e8566">2.2. Preamble</a></li>
<li><a href="#org1870411">2.3. Getting the sample metadata</a></li>
<li><a href="#orge99e183">2.4. Getting the exon boundaries</a></li>
<li><a href="#org309b4e4">2.5. Getting the VCF files</a></li>
<li><a href="#orgee3ab50">2.6. Merging the BCF files</a></li>
<li><a href="#orgbc31439">2.7. Get the genotypes</a></li>
<li><a href="#orgbc76ccb">2.8. Count the genotypes</a></li>
<li><a href="#org043f7d7">2.9. Create gene bed</a></li>
<li><a href="#org9c0236b">2.10. Get genotype counts sum per gene</a></li>
<li><a href="#orgd8db55d">2.11. Workflow</a></li>
</ul>
</li>
<li><a href="#org4875636">3. Results</a></li>
<li><a href="#orge2a1e2a">4. Discussion</a></li>
<li><a href="#orgd233781">5. References</a></li>
<li><a href="#orga8d1448">6. Acronyms</a></li>
<li><a href="#org8c4255a">7. Glossary</a></li>
<li><a href="#orgb869ab9">Comments</a></li>
</ul>
</div>
</div>
<div id="outline-container-org10035ad" class="outline-2">
<h2 id="org10035ad"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
During exome sequencing analyses, we encounter heterozygous variants on the X chromosomes in the male samples.
This is not an accurate representation of biological status as males carry only one X and are hemizygous for both sex chromosomes.
Except for the pseudoautosomal region (<a class="org-gls" href="#gls.1" id="glsr.1.1">PAR</a>), at the beginning and the end of both chromosomes X and Y span around 3Mb together.
This region shows homology between the chromosomes and males are &ldquo;homozygous&rdquo; for the regions.
This homology makes it possible for chromosomes to pair during cell division and the only place where recombination can occur between X and Y. (<a href="#citeproc_bib_item_2">Raudsepp et al. 2012</a>)
However, the variants we are seeing are located outside of the <a class="org-gls" href="#gls.1" id="glsr.1.2">PAR</a> and are spread across chromosome X.
There have also been other groups who come across this and used it to check for sample sex as a form of quality control.(<a href="#citeproc_bib_item_1">Do et al. 2015</a>)
There have been a lot of questions about this around the web with no satisfying answers.
</p>

<p>
My question was where do these variants are originated?
We will be making an empirical observation by looking at the 1000 genome project.
</p>
</div>
<div id="outline-container-orgf56fd9e" class="outline-3">
<h3 id="orgf56fd9e"><span class="section-number-3">1.1.</span> Calling variant from X chromosome in males</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Variant callers assume a diploid genome while calling variants.
Males are haploid for the X chromosome meaning there is only one chromosome.
Which doesn&rsquo;t fit the worldview of the variant callers.
What makes it even harder is the highly repetitive regions and regions that show a high degree of homology to other loci in the X chromosome.
Haplotypecaller has a parameter to give ploidy, but since the data we are dealing with doesn&rsquo;t represent a haploid chromosome fitting it into a hemizygous genotype calls might be a challenge. <a href="https://gatk.broadinstitute.org/hc/en-us/community/posts/360069340411-Why-does-sample-ploidy-ploidy-option-not-work-in-HaplotypeCaller-or-GenotypeGVCFs">1</a>, <a href="https://gatk.broadinstitute.org/hc/en-us/community/posts/4407495732635-joint-call-samples-with-different-ploidy-on-chrX-chrY-males-vs-females">2</a>, <a href="https://gatk.broadinstitute.org/hc/en-us/community/posts/360057847692-Calling-variants-on-chromosome-Y">3</a>, <a href="https://gatk.broadinstitute.org/hc/en-us/community/posts/360077511272-CombineGVCF-on-chrX-and-chrY-hg38-running-for-ever">4</a>
</p>
</div>
</div>
</div>
<div id="outline-container-orgd385aa1" class="outline-2">
<h2 id="orgd385aa1"><span class="section-number-2">2.</span> Materials and Methods</h2>
<div class="outline-text-2" id="text-2">

<div id="org63ea010" class="figure">
<p><img src="_20240626_175223screenshot.png" alt="_20240626_175223screenshot.png" data-action="zoom" />
</p>
</div>

<p>
These are whole genome  (<a class="org-gls" href="#gls.2" id="glsr.2.1">VCF</a>) files and I can&rsquo;t download them all, luckily bcftools can query specific regions on them over the line which makes it both space and speed-efficient.
The region we are going to query is the X chromosome without the <a class="org-gls" href="#gls.1" id="glsr.1.3">PAR</a>.
We are excluding the <a class="org-gls" href="#gls.1" id="glsr.1.4">PAR</a> since it&rsquo;s a diploid region.
We are going to further filtrate the variants to be heterozygous and since this all started from  (<a class="org-gls" href="#gls.3" id="glsr.3.1">ES</a>) we are just going to look at the exonic regions.
To make things simpler we are going to look at SNVs since INDELs can be challenging to genotype.
We also want to have a depth enough to decide the genotype and don&rsquo;t want anything not passing filters.
</p>

<p>
We can then merge those files into one, count the number of heterozygous genotypes we see for each position and look at them on IGV.
Later we can group them by the gene and see which genes have the most heterozygous variants.
</p>

<p>
We are going to implement all this workflow in the nextflow.
</p>
</div>
<div id="outline-container-orga7ba070" class="outline-3">
<h3 id="orga7ba070"><span class="section-number-3">2.1.</span> VCF files from the 1000genome project</h3>
<div class="outline-text-3" id="text-2-1">
<p>
For this job we are going to use individual variant call files from the project since multi-sample <a class="org-gls" href="#gls.2" id="glsr.2.2">VCF</a> are phased.
Looking at the individual variant calls there are  (<a class="org-gls" href="#gls.4" id="glsr.4.1">NYGC</a>) study from 2019.
There are two versions of these with one directory named raw​_calls​_old and another directory named raw​_calls​_updated.
</p>

<p>
The updated directory has a note related to this study that says:
</p>
<blockquote>
<p>
Chromosome X: male samples were processed through HaplotypeCaller with “&#x2013;ploidy 1” parameter applied to non-<a class="org-gls" href="#gls.1" id="glsr.1.5">PAR</a> regions, and “&#x2013;ploidy 2” parameter applied to PAR1 and PAR2 regions, whereas female samples were processed using “&#x2013;ploidy 2”  parameter applied to the entire chrX (see table below for the exact coordinates and corresponding ploidy settings).
</p>
</blockquote>

<p>
Since we want to see the genotypes called as a diploid we will be looking at the calls from the old directory.
The other different thing about the old directory is that samples are located under the major population directories.
</p>
</div>
</div>
<div id="outline-container-org65e8566" class="outline-3">
<h3 id="org65e8566"><span class="section-number-3">2.2.</span> Preamble</h3>
<div class="outline-text-3" id="text-2-2">
<p>
I had these as a variable while writing the workflow but looking at it now they don&rsquo;t need to be variables.
But I am not gonna change them either since it does make what&rsquo;s being done a bit more transparent.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #af3a03;">nextflow</span>.enable.dsl=<span style="color: #8f3f71; font-weight: bold;">2</span>

<span style="color: #af3a03;">params</span>.source = <span style="color: #79740e;">"RefSeq"</span>
<span style="color: #af3a03;">params</span>.assembly = <span style="color: #79740e;">"GRCh38"</span>
<span style="color: #af3a03;">params</span>.version = <span style="color: #79740e;">"latest"</span>
<span style="color: #af3a03;">params</span>.feature = <span style="color: #79740e;">"exon"</span>
<span style="color: #af3a03;">params</span>.annot_url = <span style="color: #79740e;">"https://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/annotation/GRCh38_latest/refseq_identifiers/GRCh38_latest_genomic.gff.gz"</span>
<span style="color: #af3a03;">params</span>.exons = <span style="color: #79740e;">"</span><span style="color: #076678;">${params.source}</span><span style="color: #79740e;">.</span><span style="color: #076678;">${params.assembly}</span><span style="color: #79740e;">.</span><span style="color: #076678;">${params.version}</span><span style="color: #79740e;">.bed.gz"</span>

<span style="color: #af3a03;">params</span>.samples_url = <span style="color: #79740e;">'https://www.internationalgenome.org/api/beta/sample/_search/igsr_samples.tsv'</span>
<span style="color: #af3a03;">params</span>.samples_data = <span style="color: #79740e;">'json=%7B%22fields%22%3A%5B%22name%22%2C%22sex%22%2C%22populations.code%22%5D%7D'</span>
<span style="color: #af3a03;">params</span>.samples_info = <span style="color: #79740e;">"igsr_samples.tsv"</span>

<span style="color: #af3a03;">params</span>.base_url = <span style="color: #79740e;">'https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20190425_NYGC_GATK/raw_calls_old'</span>
<span style="color: #af3a03;">params</span>.genotypes = <span style="color: #79740e;">"genotypes.tsv.gz"</span>
<span style="color: #af3a03;">params</span>.bedgraph = <span style="color: #79740e;">"genotype_counts.bedGraph"</span>

</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-org1870411" class="outline-3">
<h3 id="org1870411"><span class="section-number-3">2.3.</span> Getting the sample metadata</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Before everything else we need to know who is male.
1000 genomes project has a download link to their sample data on their portal page.
<a href="https://www.internationalgenome.org/data-portal/sample">https://www.internationalgenome.org/data-portal/sample</a>
</p>

<p>
This link makes an API call to another link with the given columns and returns the data.
Since we are only looking for the sex of the individuals we only need the fields name and sex but since they&rsquo;re under the population directories we are also going to need the population codes.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<label for="sn-symbol" class="sidenote-toggle">⊕</label>
<input type="checkbox" id="sn-symbol" class="sidenote-toggle">
<div class="sidenote" id="org4feb32a">
<p>
The characters with preceding percent sign are encoded versions of characters like {, [, &ldquo;, ], }.
Because only ASCII character are allowed in the URLs.
<a href="https://www.w3schools.com/tags/ref_urlencode.ASP">https://www.w3schools.com/tags/ref_urlencode.ASP</a>
{&rdquo;fields&ldquo;:[&rdquo;name&ldquo;,&rdquo;sex&ldquo;,&rdquo;populations.code"]}
</p>

</div>

<div class="org-src-container">
<pre class="src src-nextflow">curl \
<span style="color: #79740e;">'https://www.internationalgenome.org/api/beta/sample/_search/igsr_samples.tsv'</span> \
--data-raw <span style="color: #79740e;">'json=%7B%22fields%22%3A%5B%22name%22%2C%22sex%22%2C%22populations.code%22%5D%7D'</span> \
-o <span style="color: #79740e;">"igsr_samples.tsv"</span>
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-orge99e183" class="outline-3">
<h3 id="orge99e183"><span class="section-number-3">2.4.</span> Getting the exon boundaries</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Since we are interested in the exons, we need to filter for them, and for that, we need the exon boundaries.
We can get it using the annotation file from the RefSeq.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">createbedfile</span> {
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span>(<span style="color: #79740e;">"</span><span style="color: #076678;">${params.exons}</span><span style="color: #79740e;">"</span>)
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   wget -q -O- "!{params.annot_url}" |</span>
&#9474;<span style="color: #79740e;">   zcat |</span>
&#9474;<span style="color: #79740e;">   grep  'NC_000023' |</span>
&#9474;<span style="color: #79740e;">   awk -F"\t" -v feature="!{params.feature}" '</span>
&#9474;<span style="color: #79740e;">   &#9474;   /^#!/ {print}</span>
&#9474;<span style="color: #79740e;">   &#9474;   /^##/ {next}</span>
&#9474;<span style="color: #79740e;">   &#9474;   $3 ~ feature {</span>
&#9474;<span style="color: #79740e;">   &#9474;   sub(/^NC_[0]+/, "chr");</span>
&#9474;<span style="color: #79740e;">   &#9474;   sub(/^chr23/, "chrX");</span>
&#9474;<span style="color: #79740e;">   &#9474;   split($1, chrom, ".");</span>
&#9474;<span style="color: #79740e;">   &#9474;   split($9, info, "ID=");</span>
&#9474;<span style="color: #79740e;">   &#9474;   split(info[2], id, ";");</span>
&#9474;<span style="color: #79740e;">   &#9474;   printf "%s\t%s\t%s\t%s\n", chrom[1], $4, $5, id[1]}' |</span>
&#9474;<span style="color: #79740e;">   grep "NM" |</span>
&#9474;<span style="color: #79740e;">   gzip -c &gt; "!{params.exons}" &amp;&amp;</span>
&#9474;<span style="color: #79740e;">   echo "INFO: BED file created at !{params.exons}" ||</span>
&#9474;<span style="color: #79740e;">   echo "ERROR: An error occurred while creating BED file at !{params.exons}"</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>

<p>
This is an AWK command which cleans up the chromosome names and splits the info column to write the exon id to fourth BED column.
</p>
</div>
</div>
<div id="outline-container-org309b4e4" class="outline-3">
<h3 id="org309b4e4"><span class="section-number-3">2.5.</span> Getting the VCF files</h3>
<div class="outline-text-3" id="text-2-5">
<p>
For each of our samples, we create the URL for the <a class="org-gls" href="#gls.2" id="glsr.2.3">VCF</a> file and we pass it to bcftools where we perform the filtering and write it to a BCF file named after the sample.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<label for="sn-symbol" class="sidenote-toggle">⊕</label>
<input type="checkbox" id="sn-symbol" class="sidenote-toggle">
<div class="sidenote" id="org383b34d">
<p>
BCFs are more performant than <a class="org-gls" href="#gls.2" id="glsr.2.4">VCFs</a>.
<a href="https://www.biostars.org/p/273673/">https://www.biostars.org/p/273673/</a>
</p>

</div>

<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">getfiltervcf</span> {
&#9474;   <span style="color: #af3a03;">memory</span> <span style="color: #79740e;">'1 GB'</span>
&#9474;   <span style="color: #af3a03;">cpus</span> <span style="color: #8f3f71; font-weight: bold;">1</span>
&#9474;   <span style="color: #af3a03;">errorStrategy</span> <span style="color: #79740e;">'ignore'</span>
&#9474;   <span style="color: #9d0006;">input</span>:
&#9474;   <span style="color: #8f3f71;">tuple</span> <span style="color: #076678;">val</span>(sample), val(sex), val(population_code)
&#9474;   <span style="color: #8f3f71;">path</span> <span style="color: #076678;">exons</span>
&#9474;
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span> <span style="color: #79740e;">"</span><span style="color: #076678;">${sample}</span><span style="color: #79740e;">.bcf{,.csi}"</span>
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   url="!{params.base_url}/!{population_code}/Sample_!{sample}/analysis/!{sample}.haplotypeCalls.er.raw.vcf.gz"</span>
&#9474;
&#9474;<span style="color: #79740e;">   bcftools view "$url" \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -r chrX:2781479-153925834 \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -T "!{exons}" \\</span>
&#9474;<span style="color: #79740e;">   &#9474;   -v snps \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -f .,PASS \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -i 'GT=="0/1" &amp;&amp; FORMAT/DP&gt;=20' \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -Ob -o !{sample}.bcf</span>
&#9474;<span style="color: #79740e;">   bcftools index !{sample}.bcf</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-orgee3ab50" class="outline-3">
<h3 id="orgee3ab50"><span class="section-number-3">2.6.</span> Merging the BCF files</h3>
<div class="outline-text-3" id="text-2-6">
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">mergebcf</span> {
&#9474;   <span style="color: #9d0006;">input</span>:
&#9474;   <span style="color: #8f3f71;">path</span>(bcfs)
&#9474;
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span> <span style="color: #79740e;">'merged/merged.bcf'</span>
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   mkdir merged/</span>
&#9474;<span style="color: #79740e;">   bcftools merge *.bcf -Ob -o merged/merged.bcf &amp;&amp;</span>
&#9474;<span style="color: #79740e;">   echo "INFO: Merged BCF file created at merged.bcf" ||</span>
&#9474;<span style="color: #79740e;">   echo "ERROR: An error occurred while merging BCF files"</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-orgbc31439" class="outline-3">
<h3 id="orgbc31439"><span class="section-number-3">2.7.</span> Get the genotypes</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Bcftools is the workhorse of this pipeline.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">getgenotypes</span> {
&#9474;   <span style="color: #9d0006;">input</span>:
&#9474;   <span style="color: #8f3f71;">path</span> <span style="color: #79740e;">'merged.bcf'</span>
&#9474;
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span>(<span style="color: #af3a03;">params</span>.genotypes)
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   bcftools query \</span>
&#9474;<span style="color: #79740e;">   &#9474; merged.bcf \</span>
&#9474;<span style="color: #79740e;">   &#9474; -f '%CHROM\t%POS[\t%GT]\n' | \</span>
&#9474;<span style="color: #79740e;">   &#9474; gzip -c &gt; !{params.genotypes} &amp;&amp;</span>
&#9474;<span style="color: #79740e;">   &#9474; echo "INFO: Genotypes file created at !{params.genotypes}" ||</span>
&#9474;<span style="color: #79740e;">   &#9474; echo "ERROR: An error occurred while extracting genotypes"</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-orgbc76ccb" class="outline-3">
<h3 id="orgbc76ccb"><span class="section-number-3">2.8.</span> Count the genotypes</h3>
<div class="outline-text-3" id="text-2-8">
<p>
To count we are using awk, and printing them out in a bedGraph format.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<label for="sn-symbol" class="sidenote-toggle">⊕</label>
<input type="checkbox" id="sn-symbol" class="sidenote-toggle">
<div class="sidenote" id="org99fc4f3">
<p>
<a href="https://genome.ucsc.edu/goldenPath/help/bedgraph.html">https://genome.ucsc.edu/goldenPath/help/bedgraph.html</a>
</p>

</div>

<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">createbedgraph</span> {
&#9474;   <span style="color: #9d0006;">input</span>:
&#9474;   <span style="color: #8f3f71;">path</span>(<span style="color: #af3a03;">params</span>.genotypes)
&#9474;
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span>(<span style="color: #af3a03;">params</span>.bedgraph)
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   zcat !{params.genotypes} | awk -F"\t" 'BEGIN {</span>
&#9474;<span style="color: #79740e;">   &#9474;   print "track type=bedGraph visibility=full color=255,153,0 altColor=0,0,0"</span>
&#9474;<span style="color: #79740e;">   }</span>
&#9474;<span style="color: #79740e;">   {</span>
&#9474;<span style="color: #79740e;">   &#9474; count = 0</span>
&#9474;<span style="color: #79740e;">   &#9474; for (i = 3; i &lt;= NF; i++) {</span>
&#9474;<span style="color: #79740e;">   &#9474;   if ($i == "0/1") count++</span>
&#9474;<span style="color: #79740e;">   &#9474; }</span>
&#9474;<span style="color: #79740e;">   &#9474; printf "%s\t%s\t%s\t%s\n" $1, $2, $2, count</span>
&#9474;<span style="color: #79740e;">   }' &gt; !{params.bedgraph} &amp;&amp;</span>
&#9474;<span style="color: #79740e;">   echo "INFO: BedGraph file created at !{params.bedgraph}" ||</span>
&#9474;<span style="color: #79740e;">   echo "ERROR: An error occurred while creating BedGraph file"</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-org043f7d7" class="outline-3">
<h3 id="org043f7d7"><span class="section-number-3">2.9.</span> Create gene bed</h3>
<div class="outline-text-3" id="text-2-9">
<p>
This is pretty much the same as <a href="#orge99e183">what we did with the exons</a> but with the genes.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">creategenebed</span> {
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span> <span style="color: #79740e;">"genes.bed"</span>
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   wget -q -O- "!{params.annot_url}" |</span>
&#9474;<span style="color: #79740e;">   zcat |</span>
&#9474;<span style="color: #79740e;">   grep  'NC_000023' |</span>
&#9474;<span style="color: #79740e;">   awk -F"\t" -v feature="gene" '</span>
&#9474;<span style="color: #79740e;">   &#9474;   /^#!/ {print}</span>
&#9474;<span style="color: #79740e;">   &#9474;   /^##/ {next}</span>
&#9474;<span style="color: #79740e;">   &#9474;   $3 ~ feature {</span>
&#9474;<span style="color: #79740e;">   &#9474;   sub(/^NC_[0]+/, "chr");</span>
&#9474;<span style="color: #79740e;">   &#9474;   sub(/^chr23/, "chrX");</span>
&#9474;<span style="color: #79740e;">   &#9474;   split($1, chrom, ".");</span>
&#9474;<span style="color: #79740e;">   &#9474;   split($9, info, "ID=");</span>
&#9474;<span style="color: #79740e;">   &#9474;   split(info[2], id, ";");</span>
&#9474;<span style="color: #79740e;">   &#9474;   printf "%s\t%s\t%s\t%s\n", chrom[1], $4, $5, id[1]}' |</span>
&#9474;<span style="color: #79740e;">   gzip -c &gt; "genes.bed.gz" &amp;&amp;</span>
&#9474;<span style="color: #79740e;">   echo "INFO: BED file created at genes.bed" ||</span>
&#9474;<span style="color: #79740e;">   echo "ERROR: An error occurred while creating BED file at genes.bed"</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-org9c0236b" class="outline-3">
<h3 id="org9c0236b"><span class="section-number-3">2.10.</span> Get genotype counts sum per gene</h3>
<div class="outline-text-3" id="text-2-10">
<p>
This looks long but there is no benefit splitting into separate tasks.
Two similar tasks are being performed here only difference between the commands is the datamash operations we are performing.
<a href="#coderef-datamash_count" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-datamash_count');" onmouseout="CodeHighlightOff(this, 'coderef-datamash_count');">One counts the number of positions</a> and <a href="#coderef-datamash_sum" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-datamash_sum');" onmouseout="CodeHighlightOff(this, 'coderef-datamash_sum');">other sums the actual genetype counts</a>.
</p>

<p>
We perform the same operation for both of them by getting the top 20 and merging back the gene positions.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">process</span> <span style="color: #b57614;">getgenecounts</span> {
&#9474;
&#9474;   <span style="color: #9d0006;">input</span>:
&#9474;   <span style="color: #8f3f71;">path</span>(genotype_counts), path(genes_bed)
&#9474;
&#9474;   <span style="color: #9d0006;">output</span>:
&#9474;   <span style="color: #8f3f71;">path</span> <span style="color: #79740e;">"genotype_counts_by_gene.txt"</span>
&#9474;
&#9474;   <span style="color: #9d0006;">shell</span>:
&#9474;   <span style="color: #79740e;">'''</span>
&#9474;<span style="color: #79740e;">   bedtools intersect \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -a !{genotype_counts} \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -b !{genes_bed} -wb |</span>
&#9474;<span style="color: #79740e;">   &#9474;   awk '{printf "%s\t%s\t%s\t%s\t%s\n", $1, $2, $3, $4, $8}' |</span>
<span id="coderef-datamash_sum" class="coderef-off">&#9474;<span style="color: #79740e;">   &#9474;   datamash -s -g 5 sum 4 |</span></span>
&#9474;<span style="color: #79740e;">   &#9474;   sort -k 2,2n &gt; genotype_counts_per_gene_by_sum.txt</span>
&#9474;   &#9474;
&#9474;<span style="color: #79740e;">   bedtools intersect \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -a !{genotype_counts} \</span>
&#9474;<span style="color: #79740e;">   &#9474;   -b !{genes_bed} -wb |</span>
&#9474;<span style="color: #79740e;">   &#9474;   awk '{printf "%s\t%s\t%s\t%s\t%s\n", $1, $2, $3, $4, $8}' |</span>
<span id="coderef-datamash_count" class="coderef-off">&#9474;<span style="color: #79740e;">   &#9474;   datamash -s -g 5 count 4 |</span></span>
&#9474;<span style="color: #79740e;">   &#9474;   sort -k 2,2n &gt; genotype_counts_per_gene_by_count.txt</span>
&#9474;   &#9474;
&#9474;<span style="color: #79740e;">   tail -n 20 genotype_counts_per_gene_by_sum.txt | sort &gt; top_20_genes_by_sum_sorted_by_name.txt</span>
&#9474;<span style="color: #79740e;">   zcat genes.bed.gz | awk '{printf "%s\t%s\t%s\t%s\n", $4,$1,$2,$3}' | sort -k 1,1 &gt; genes_sorted_by_name.bed</span>
&#9474;<span style="color: #79740e;">   join top_20_genes_by_sum_sorted_by_name.txt genes_sorted_by_name.bed | awk '{printf "%s\t%s\t%s\t%s\n", $3, $4, $5, $1}'&gt; top_20_genes_by_sum_with_positions.bed</span>
&#9474;
&#9474;<span style="color: #79740e;">   tail -n 20 genotype_counts_per_gene_by_count.txt | sort &gt; top_20_genes_by_count_sorted_by_name.txt</span>
&#9474;<span style="color: #79740e;">   zcat genes.bed.gz | awk '{printf "%s\t%s\t%s\t%s\n", $4,$1,$2,$3}' | sort -k 1,1 &gt; genes_sorted_by_name.bed</span>
&#9474;<span style="color: #79740e;">   join top_20_genes_by_count_sorted_by_name.txt genes_sorted_by_name.bed | awk '{printf "%s\t%s\t%s\t%s\n", $3, $4, $5, $1}'&gt; top_20_genes_by_count_with_positions.bed</span>
&#9474;<span style="color: #79740e;">   '''</span>
}
</pre>
</div>


</details>
</div>
</div>
<div id="outline-container-orgd8db55d" class="outline-3">
<h3 id="orgd8db55d"><span class="section-number-3">2.11.</span> Workflow</h3>
<div class="outline-text-3" id="text-2-11">
<p>
Here only notable parts are; that we are splitting the samplesheet and filtering by male and collecting the bcf files before passing to them to <code>mergebcf</code> process.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Click to see the implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-nextflow"><span style="color: #9d0006;">workflow</span> {
&#9474;   getsamplesheet()
&#9474;   samplesheet = getsamplesheet.out
&#9474;   samplesheet
&#9474;   &#9474;   .splitCsv(header:[<span style="color: #79740e;">"sample"</span>, <span style="color: #79740e;">"sex"</span>, <span style="color: #79740e;">"population_code"</span>],
&#9474;   &#9474;   &#9474;   sep:<span style="color: #79740e;">"\t"</span>,
&#9474;   &#9474;   &#9474;   skip:<span style="color: #8f3f71; font-weight: bold;">1</span>
&#9474;   &#9474;   )
&#9474;   &#9474;   .filter { row -&gt; row.sex == <span style="color: #79740e;">"male"</span> &amp;&amp; row.population_code }
&#9474;   &#9474;   | set {samples}
&#9474;   createbedfile()
&#9474;   bcfs = getfiltervcf(samples, createbedfile.out)
&#9474;   mergebcf(bcfs.collect())
&#9474;   getgenotypes(mergebcf.out)
&#9474;   createbedgraph(getgenotypes.out)
&#9474;   creategenebed()
&#9474;   getgenecounts(
&#9474;   &#9474;   createbedgraph.out
&#9474;   &#9474;   creategenebed.out
&#9474;   )
}
</pre>
</div>


</details>
</div>
</div>
</div>
<div id="outline-container-org4875636" class="outline-2">
<h2 id="org4875636"><span class="section-number-2">3.</span> Results</h2>
<div class="outline-text-2" id="text-3">
<p>
We found a total of 71553 heterozygous genotype calls in 1223 male samples.
2 pairs of the genes here are overlapping;  <i>PABPC1P3</i> overlaps <i>RLIM</i> and <i>DDX53</i> overlaps <i>PTCHD1-AS</i>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> First group shows the sum of the heterozygous genotype counts in given gene. Second group shows the count of heterozygous positions in given gene.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">symbol</th>
<th scope="col" class="org-right">sum of genotype counts</th>
<th scope="col" class="org-left">symbol</th>
<th scope="col" class="org-right">number of het positions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><i>SLC25A5</i></td>
<td class="org-right">30694</td>
<td class="org-left"><i>LRCH2</i></td>
<td class="org-right">169</td>
</tr>

<tr>
<td class="org-left"><i>RLIM</i></td>
<td class="org-right">10839</td>
<td class="org-left"><i>RBMXL3</i></td>
<td class="org-right">162</td>
</tr>

<tr>
<td class="org-left"><i>PABPC1P3</i></td>
<td class="org-right">10824</td>
<td class="org-left"><i>PWWP4</i></td>
<td class="org-right">120</td>
</tr>

<tr>
<td class="org-left"><i>RBMX</i></td>
<td class="org-right">10370</td>
<td class="org-left"><i>SLC25A5</i></td>
<td class="org-right">79</td>
</tr>

<tr>
<td class="org-left"><i>XAGE3</i></td>
<td class="org-right">3537</td>
<td class="org-left"><i>MAGEC1</i></td>
<td class="org-right">72</td>
</tr>

<tr>
<td class="org-left"><i>MAGEC1</i></td>
<td class="org-right">2120</td>
<td class="org-left"><i>ARMCX4</i></td>
<td class="org-right">63</td>
</tr>

<tr>
<td class="org-left"><i>ZXDB</i></td>
<td class="org-right">1135</td>
<td class="org-left"><i>VCX3A</i></td>
<td class="org-right">63</td>
</tr>

<tr>
<td class="org-left"><i>CT45A3</i></td>
<td class="org-right">937</td>
<td class="org-left"><i>MAGEE1</i></td>
<td class="org-right">58</td>
</tr>

<tr>
<td class="org-left"><i>GAGE2A</i></td>
<td class="org-right">606</td>
<td class="org-left"><i>SPANXB1</i></td>
<td class="org-right">56</td>
</tr>

<tr>
<td class="org-left"><i>PTCHD1-AS</i></td>
<td class="org-right">597</td>
<td class="org-left"><i>FAM47C</i></td>
<td class="org-right">48</td>
</tr>

<tr>
<td class="org-left"><i>DDX53</i></td>
<td class="org-right">596</td>
<td class="org-left"><i>RLIM</i></td>
<td class="org-right">47</td>
</tr>

<tr>
<td class="org-left"><i>SPANXB1</i></td>
<td class="org-right">572</td>
<td class="org-left"><i>PABPC1P3</i></td>
<td class="org-right">41</td>
</tr>

<tr>
<td class="org-left"><i>GAGE12B</i></td>
<td class="org-right">564</td>
<td class="org-left"><i>NKAP</i></td>
<td class="org-right">40</td>
</tr>

<tr>
<td class="org-left"><i>PWWP4</i></td>
<td class="org-right">517</td>
<td class="org-left"><i>TEX13C</i></td>
<td class="org-right">40</td>
</tr>

<tr>
<td class="org-left"><i>SPANXD</i></td>
<td class="org-right">493</td>
<td class="org-left"><i>RBMX</i></td>
<td class="org-right">37</td>
</tr>

<tr>
<td class="org-left"><i>VCX3B</i></td>
<td class="org-right">436</td>
<td class="org-left"><i>TRAPPC2</i></td>
<td class="org-right">35</td>
</tr>

<tr>
<td class="org-left"><i>GAGE13</i></td>
<td class="org-right">393</td>
<td class="org-left"><i>FGF13</i></td>
<td class="org-right">34</td>
</tr>

<tr>
<td class="org-left"><i>VCX</i></td>
<td class="org-right">338</td>
<td class="org-left"><i>GAGE2A</i></td>
<td class="org-right">34</td>
</tr>

<tr>
<td class="org-left"><i>GAGE10</i></td>
<td class="org-right">310</td>
<td class="org-left"><i>NR0B1</i></td>
<td class="org-right">33</td>
</tr>

<tr>
<td class="org-left"><i>LRCH2</i></td>
<td class="org-right">290</td>
<td class="org-left"><i>VCX</i></td>
<td class="org-right">33</td>
</tr>
</tbody>
</table>


<div id="org1fa7708" class="figure">
<p><img src="_20240619_182836screenshot.png" alt="_20240619_182836screenshot.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 1: </span>Sum of genotype counts with close up to some genes. There are four tracks here. The first track shows the genotype counts along the whole chromosome X. Second track is the major regions in chromosome X (<a class="org-gls" href="#gls.1" id="glsr.1.6">PAR</a>, x-added region (<a class="org-gls" href="#gls.5" id="glsr.5.1">XAR</a>), x-conserved region (<a class="org-gls" href="#gls.6" id="glsr.6.1">XCR</a>), x-transposed region (<a class="org-gls" href="#gls.7" id="glsr.7.1">XTR</a>)). Below that is the low complexity and <a class="org-gls" href="#gls.8" id="glsr.8.1">ampliconic regions</a>. At the bottom top 20 genes with the highest heterozygous genotype counts sum. Close-up IGV screenshots of some genes and regions are also included to give a better sense.</p>
</div>

<p>
To further investigate I run the BLAT tool on IGV on some of the hits. The tracks with the gray bars show the BLAT matches.
</p>

<div id="orga1482a8" class="figure">
<p><img src="IGVscreenshots/SLC25A5.png" alt="SLC25A5.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 2: </span>BLAT query of <i>SLC25A5</i>  on chrX.</p>
</div>


<div id="org5d666d7" class="figure">
<p><img src="IGVscreenshots/SLC25A5_chr2.png" alt="SLC25A5_chr2.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 3: </span>BLAT query of <i>SLC25A5</i>  on chr2.</p>
</div>


<div id="org42da7d6" class="figure">
<p><img src="IGVscreenshots/SLC25A5_chr7.png" alt="SLC25A5_chr7.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 4: </span>BLAT query of <i>SLC25A5</i>  on chr7.</p>
</div>


<div id="org5e1f22c" class="figure">
<p><img src="IGVscreenshots/SLC25A5_chr9.png" alt="SLC25A5_chr9.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 5: </span>BLAT query of <i>SLC25A5</i>  on chr9.</p>
</div>


<div id="orgc62d36d" class="figure">
<p><img src="IGVscreenshots/RBMX.png" alt="RBMX.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 6: </span>BLAT query of <i>RBMX</i> on chrX.</p>
</div>


<div id="orgd36e110" class="figure">
<p><img src="IGVscreenshots/RLIM.png" alt="RLIM.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 7: </span>BLAT query of <i>RLIM</i> on chrX.</p>
</div>


<div id="org1f05ebd" class="figure">
<p><img src="IGVscreenshots/RBMXL3.png" alt="RBMXL3.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 8: </span>BLAT query of <i>RBMXL3</i> on chrX.</p>
</div>


<div id="orgda7b5f6" class="figure">
<p><img src="IGVscreenshots/RBMXL3_chr11.png" alt="RBMXL3_chr11.png" data-action="zoom" />
</p>
<p><span class="figure-number">Figure 9: </span>BLAT query of <i>RBMXL3</i> on chr11.</p>
</div>
</div>
</div>
<div id="outline-container-orge2a1e2a" class="outline-2">
<h2 id="orge2a1e2a"><span class="section-number-2">4.</span> Discussion</h2>
<div class="outline-text-2" id="text-4">
<p>
The BLAT results shows exons of <i>SLC25A5</i> in other chromosomes namely 2, 7, and 9 without its introns.
Searching by the gene symbol alone in genenames.org shows it has 9 pseudogenes <i>SLC25A5P1-9</i>.
It looks like there have been multiple retrotranspositions events.
The one on the chr7 doesn&rsquo;t have an annotation on RefSeq.
</p>

<p>
Another one with high amount of heterozgosity is the <i>RBMX</i> gene.
There is a naming conviction of gametolog gene symbols: if it ends with &ldquo;X&rdquo;, that gene might have a gametolog on chromosome Y which its symbol ends with &ldquo;Y&rdquo;.
e.g. <i>AMELX</i> and <i>AMELY</i> or <i>PRKX</i> and <i>PRKY</i>.
In this case however, there is no gene named <i>RBMY</i> but multiple <i>RBMY1A</i>, <i>RBMY1B</i> etc.
<i>RBMX</i> is a member of a gene family, which their members reside in chromose Y.
BLAT of our <i>RMBX</i> exon 9 doesn&rsquo;t return any hits to any of the Y chromosome relatives.
But, the <i>RBMX</i> has multiple pseudogenes on chromosomes 1, 4, 6, 9, 11 according to NCBI gene summary like <i>SLC25A5</i> also derived from retrotransposition events.
</p>

<p>
Maybe what we are seeing here might be the one of the limitations of short read sequencing.
Our genome has the same sequences scatter around with events like retrotransposition, duplications, and translocations.
We can&rsquo;t separate where these reads are coming from and seeing them mistakenly aligned.
</p>

<p>
Here we just looked at the chromosome X but its most likely the same errors happen all around the genome.
There will be other regions with false mappings and sequence errors in the genome that we will inadvertently see as heterozygous.
We are just not looking because they&rsquo;re diploid regions and seeing heterozgous variants is expected.
</p>

<label for="sn-symbol" class="sidenote-toggle">⊕</label>
<input type="checkbox" id="sn-symbol" class="sidenote-toggle">
<div class="sidenote" id="orgdbfdf25">

<div id="org9c844b4" class="figure">
<p><img src="_20240620_012744screenshot.png" alt="_20240620_012744screenshot.png" />
</p>
<p><span class="figure-number">Figure 10: </span><a href="https://en.wikipedia.org/wiki/Thomas_Hunt_Morgan">Discovery of gene-chromosome relation</a></p>
</div>

</div>
<p>
Studying sex chromosomes shows us a different view  because of their unique inheritance and biology and makes it possible to further question our models.
This has been a qualitative investigation and haven&rsquo;t looked at the <a href="https://www.biostars.org/p/361558/#361678">variant allele fractions</a>.
Maybe the X chromosome can be use to model this <code>(pseudogene and gene family) - varaint allele fraction</code> relation to re calibrate variant heterozygosity in sequencing studies.
</p>
</div>
</div>
<div id="outline-container-orgd233781" class="outline-2">
<h2 id="orgd233781"><span class="section-number-2">5.</span> References</h2>
<div class="outline-text-2" id="text-5">
<style>.csl-entry{text-indent: -1.5em; margin-left: 1.5em;}</style><div class="csl-bib-body">
  <div class="csl-entry"><a id="citeproc_bib_item_1"></a>Do, Ron, Nathan O. Stitziel, Hong-Hee Won, Anders Berg Jørgensen, Stefano Duga, Pier Angelica Merlini, Adam Kiezun, et al. 2015. “Exome Sequencing Identifies Rare LDLR and APOA5 Alleles Conferring Risk for Myocardial Infarction.” <i>Nature</i> 518 (7537): 102–6. <a href="https://doi.org/10.1038/nature13917">https://doi.org/10.1038/nature13917</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_2"></a>Raudsepp, T., P. J. Das, F. Avila, and B. P. Chowdhary. 2012. “The Pseudoautosomal Region and Sex Chromosome Aneuploidies in Domestic Species.” <i>Sexual Development: Genetics, Molecular Biology, Evolution, Endocrinology, Embryology, and Pathology of Sex Determination and Differentiation</i> 6 (1-3): 72–83. <a href="https://doi.org/10.1159/000330627">https://doi.org/10.1159/000330627</a>.</div>
</div>
</div>
</div>
<div id="outline-container-orga8d1448" class="outline-2">
<h2 id="orga8d1448"><span class="section-number-2">6.</span> Acronyms</h2>
<div class="outline-text-2" id="text-6">
<p>
<b><span class="org-glsdef" id="gls.12">ES</span></b>&emsp;&ensp;<a class="org-glsdef" href="#glsr.3.1">1</a>
</p>

<p>
<b><span class="org-glsdef" id="gls.6">NYGC</span></b>&emsp;&ensp;<a class="org-glsdef" href="#glsr.4.1">1</a>
</p>

<p>
<b><span class="org-glsdef" id="gls.5">VCF</span></b>&emsp;&ensp;<a class="org-glsdef" href="#glsr.2.1">1</a>, <a class="org-glsdef" href="#glsr.2.2">2</a>, <a class="org-glsdef" href="#glsr.2.3">3</a>, <a class="org-glsdef" href="#glsr.2.4">4</a>
</p>
</div>
</div>
<div id="outline-container-org8c4255a" class="outline-2">
<h2 id="org8c4255a"><span class="section-number-2">7.</span> Glossary</h2>
<div class="outline-text-2" id="text-7">
<p>
<b><span class="org-glsdef" id="gls.20">Ampliconic region</span></b>&emsp;Large regions (about 30% of the MSY euchromatin) where sequence pairs show greater than 99.9% identity, which is maintained by frequent gene conversion (non-reciprocal transfer)&ensp;<a class="org-glsdef" href="#glsr.8.1">1</a>
</p>

<p>
<b><span class="org-glsdef" id="gls.1">Pseudoautosomal region</span></b>&emsp;Region shared between the allosomes. PARs are located at the end of the chromosomes.&ensp;<a class="org-glsdef" href="#glsr.1.1">1</a>, <a class="org-glsdef" href="#glsr.1.2">2</a>, <a class="org-glsdef" href="#glsr.1.3">3</a>, <a class="org-glsdef" href="#glsr.1.4">4</a>, <a class="org-glsdef" href="#glsr.1.5">5</a>, <a class="org-glsdef" href="#glsr.1.6">6</a>
</p>

<p>
<b><span class="org-glsdef" id="gls.19">X-transposed region</span></b>&emsp;The X-transposed sequences are 99% identical to DNA sequences in Xq21 originating from X-to-Y transposition event from 3–4 million years ago.&ensp;<a class="org-glsdef" href="#glsr.7.1">1</a>
</p>

<p>
<b><span class="org-glsdef" id="gls.2">X-conserved region</span></b>&emsp;X region that is evolutionary conversed between therian mammals.&ensp;<a class="org-glsdef" href="#glsr.6.1">1</a>
</p>

<p>
<b><span class="org-glsdef" id="gls.15">X-added region</span></b>&emsp;X region that is recently added in the eutherian lineage.&ensp;<a class="org-glsdef" href="#glsr.5.1">1</a>
</p>
</div>
</div>
<div id="outline-container-orgb869ab9" class="outline-2">
<h2 id="orgb869ab9">Comments</h2>
<div class="outline-text-2" id="text-orgb869ab9">
<section id="isso-thread">
<noscript>Javascript needs to be activated to view comments.</noscript>
</section>

<script src="https://cdn.jsdelivr.net/npm/zoom-vanilla.js/dist/zoom-vanilla.min.js" type="text/javascript"></script>

<div id="progress-bar"></div>
</div>
</div>
</div>
<div id="postamble" class="status">

<script src="https://omics.sbs/static/base/js/script.js"></script>
</div>
</body>
</html>
